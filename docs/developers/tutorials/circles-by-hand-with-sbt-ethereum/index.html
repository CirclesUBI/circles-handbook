<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Circles UBI | Handbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Circles UBI | Handbook Blog Atom Feed"><title data-react-helmet="true">Circles by hand with sbt-ethereum | Circles UBI | Handbook</title><meta data-react-helmet="true" property="og:url" content="https://handbook.joincircles.net/docs/developers/tutorials/circles-by-hand-with-sbt-ethereum"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Circles by hand with sbt-ethereum | Circles UBI | Handbook"><meta data-react-helmet="true" name="description" content="Author: Steve Randy Waldman 2021-03-23"><meta data-react-helmet="true" property="og:description" content="Author: Steve Randy Waldman 2021-03-23"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://handbook.joincircles.net/docs/developers/tutorials/circles-by-hand-with-sbt-ethereum"><link data-react-helmet="true" rel="alternate" href="https://handbook.joincircles.net/docs/developers/tutorials/circles-by-hand-with-sbt-ethereum" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://handbook.joincircles.net/docs/developers/tutorials/circles-by-hand-with-sbt-ethereum" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.12b1e604.css">
<link rel="preload" href="/assets/js/runtime~main.c3b470af.js" as="script">
<link rel="preload" href="/assets/js/main.4528a3a6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/images/logo.svg" alt="Circles UBI" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/logo.svg" alt="Circles UBI" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Circles Handbook</strong></a><a class="navbar__item navbar__link" href="/docs/users">Users</a><a class="navbar__item navbar__link" href="/docs/communities">Communities</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/developers">Developers</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/developers/whitepaper">Whitepaper</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/images/logo.svg" alt="Circles UBI" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/logo.svg" alt="Circles UBI" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Circles Handbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/users">Users</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/communities">Communities</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/developers">Developers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/developers/whitepaper">Whitepaper</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Circles by hand with sbt-ethereum</h1></header><div class="markdown"><p><em>Author: Steve Randy Waldman 2021-03-23</em></p><p>Here we‚Äôll go through the exercise of creating a <em>Circles</em> identity by hand with sbt-ethereum.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-web-app-is-weird"></a>The web-app is weird<a class="hash-link" href="#the-web-app-is-weird" title="Direct link to heading">#</a></h2><p>Our command-line adventure will be <strong>very, very</strong> different from the experience the <em>Circles</em> web application encourages of users. (See <a href="https://joincircles.net/" target="_blank" rel="noopener noreferrer">https://joincircles.net/</a> and <a href="https://circles.garden/." target="_blank" rel="noopener noreferrer">https://circles.garden/.</a>) The UI works to hide or abstract nearly all the details of working with an <em>Ethereum</em>-ish blockchain application. Users via the web UI don‚Äôt use a browser-based crypto wallet like <em>Metamask</em>. Instead, they sign up as for a Web 2.0 application with an e-mail address and username. A private key is then generated for the user, presented as a <a href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki" target="_blank" rel="noopener noreferrer">BIP-39-style</a> list of words.</p><p>An address ‚Äî the user‚Äôs identity ‚Äî is also defined for each user, but that address is not the same address as that for which the private key was generated. Instead it is as address to which a <a href="https://gnosis-safe.io/" target="_blank" rel="noopener noreferrer">Gnosis Safe</a> contract (or really a proxy thereof) can eventually be deployed via the EVM <a href="https://eips.ethereum.org/EIPS/eip-1014" target="_blank" rel="noopener noreferrer"><code>CREATE2</code></a> opcode. eventually. Eventually.</p><p>But, because in the web application <em>Circles</em> (or <a href="https://gnosis.io/" target="_blank" rel="noopener noreferrer">Gnosis</a>, or someone) is handling the gas costs for user transactions, it had to be built with a degree of caution. If any signup provoked smart contract creations or transactions, miscreants could force arbitrary expenses on the payer just by spoofing new users. To prevent this, the <em>Circles</em> requires new users to become trusted by at least three existing users before their identity (the <a href="https://gnosis-safe.io/" target="_blank" rel="noopener noreferrer">Gnosis Safe</a> proxy) is actually materialized on the blockchain, along with their own ERC-20 token (the <a href="https://www.sbt-ethereum.io/blog/2021/03/14/Circles-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">‚Äúme-coin‚Äù</a>) in which they‚Äôll receive their UBI.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="circles-contracts"></a>Circles contracts<a class="hash-link" href="#circles-contracts" title="Direct link to heading">#</a></h2><p>Behind the <em>Circles</em> application sits three contracts on the <a href="https://blockscout.com/poa/xdai" target="_blank" rel="noopener noreferrer">xDAI blockchain</a>. Pretty much the only place I found the addresses of these contracts documented is in <a href="https://twitter.com/CirclesUBI/status/1317089774293962753" target="_blank" rel="noopener noreferrer">this tweet</a>. The three contracts are‚Ä¶</p><ol><li>The Hub @ <a href="https://blockscout.com/xdai/mainnet/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/transactions" target="_blank" rel="noopener noreferrer"><code>0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</code></a>: This is the core of the <em>Circles</em> application, the smart contract that tracks identities and trust relationships, and that launches token contracts for each <em>Circles</em> identity. We will interact with this contract. (We‚Äôve reproduced its full source code as an <a href="https://www.sbt-ethereum.io/blog/2021/03/23/Circles-with-sbt-ethereum-II-Circles-by-hand-redux.html#Appendix-Circles-hub-source-code" target="_blank" rel="noopener noreferrer">appendix</a> to this post.)</li><li>The Proxy Factory @ <a href="https://blockscout.com/xdai/mainnet/address/0x8b4404DE0CaECE4b966a9959f134f0eFDa636156/transactions" target="_blank" rel="noopener noreferrer"><code>0x8b4404DE0CaECE4b966a9959f134f0eFDa636156</code></a>: This contract is invoked by the middleware / web-UI to create proxy <a href="https://gnosis-safe.io/" target="_blank" rel="noopener noreferrer">Gnosis Safe</a> contracts, representing user identities.</li><li>The Master Gnosis Safe @ <a href="https://blockscout.com/xdai/mainnet/address/0x2CB0ebc503dE87CFD8f0eCEED8197bF7850184ae/transactions" target="_blank" rel="noopener noreferrer"><code>0x2CB0ebc503dE87CFD8f0eCEED8197bF7850184ae</code></a>: Identities are efficiently implemented as tiny proxies to a <a href="https://gnosis-safe.io/" target="_blank" rel="noopener noreferrer">Gnosis Safe</a> implementation, and this is that implementation. Operations on the contracts that represent users happen via <code>DELEGATECALL</code> to this master implementation.</li></ol><p><strong><em>Note:</em></strong> <em>When I first examined <a href="https://blockscout.com/xdai/mainnet/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/transactions" target="_blank" rel="noopener noreferrer">the hub on the xDAI block explorer</a>, I thought it must be misidentified. Transactions involving it seemed too few and infrequent. But that‚Äôs not right. Since nearly all activity involving the hub is initiated by a user identity, which are nearly all <a href="https://gnosis-safe.io/" target="_blank" rel="noopener noreferrer">Gnosis Safe</a> contracts, the calls to hub methods are treated as <a href="https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/internal-transactions" target="_blank" rel="noopener noreferrer">internal transactions</a>, of which there are plenty.</em></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="circles-by-hand"></a>Circles by hand<a class="hash-link" href="#circles-by-hand" title="Direct link to heading">#</a></h2><p>If you want to play along, you‚Äôll need to have set up your sbt-ethereum environment to work on the xDAI blockchain. Please see previous posts <a href="https://www.sbt-ethereum.io/blog/2021/02/19/Getting-started-on-the-xDAI-chain-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">to get started on xDAI</a>, and <a href="https://www.sbt-ethereum.io/blog/2021/02/20/Converting-DAI-to-xDAI-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">to give yourself some xDAI to fund transactions</a>.</p><p>Since you‚Äôre too lazy to review those posts (I would be!), I‚Äôll work from an empty sbt-ethereum shoebox (by using the setting <a href="https://www.sbt-ethereum.io/settings/index.html#ethcfgshoeboxdirectory" target="_blank" rel="noopener noreferrer"><code>ethcfgShoeboxDirectory</code></a> in my <code>build.sbt</code> file, so my main shoebox is not used). <em>But if you are following along, and you want to make a Circles identity you will keep, don‚Äôt do this!</em>. Use your default shoebox directory, so that your identity is permanently available by default. You should be able to follow along with every step, except the part about having someone send you some xDAI so you can run transactions. You‚Äôll have to find a friend, try the <a href="https://www.xdaichain.com/for-users/get-xdai-tokens/xdai-faucet" target="_blank" rel="noopener noreferrer">semi-abandoned faucet</a>, or <a href="https://www.sbt-ethereum.io/blog/2021/02/20/Converting-DAI-to-xDAI-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">use the DAI-to-xDAI bridge yourself</a>. (Feel free to <a href="mailto:swaldman@mchange.com" target="_blank" rel="noopener noreferrer">hit me up</a> for the few cents you‚Äôll need.)</p><p>Let‚Äôs get started! I‚Äôll assume you have <a href="https://www.sbt-ethereum.io/appendix/prerequisites.html" target="_blank" rel="noopener noreferrer"><em>sbt-ethereum‚Äòs</em> prerequisites</a>, <em>sbt</em> and a JVM, on your machine already.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-a-new-project"></a>Create a new project<a class="hash-link" href="#create-a-new-project" title="Direct link to heading">#</a></h3><p>Through the terminal we can create a project as shown below. When prompted for a project name I choose <code>circles-tutorial</code>. Then change into the new project directory.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sbt new swaldman/solidity-seed.g8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Loading settings for project global-plugins from dependency-graph.sbt,metals.sbt,gpg.sbt ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Loading global plugins from /Users/swaldman/.sbt/1.0/plugins</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] There may be incompatibilities among your library dependencies; run &#x27;evicted&#x27; to see detailed eviction warnings.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Loading project definition from /Users/swaldman/project</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] There may be incompatibilities among your library dependencies; run &#x27;evicted&#x27; to see detailed eviction warnings.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Set current project to swaldman (in build file:/Users/swaldman/)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Set current project to swaldman (in build file:/Users/swaldman/)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">A minimal solidity project for sbt-ethereum </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">name [my-solidity-project]: circles-tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">version [0.0.1-SNAPSHOT]: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt_ethereum_version [0.5.3]: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt_version [1.3.13]: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Template applied in /Users/swaldman/./circles-tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ cd circles-tutorial/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="check-out-buildsbt"></a>Check out build.sbt<a class="hash-link" href="#check-out-buildsbt" title="Direct link to heading">#</a></h3><p>It looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">name := &quot;circles-tutorial&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">version := &quot;0.0.1-SNAPSHOT&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Because I <a href="https://www.sbt-ethereum.io/blog/2021/03/14/Circles-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">already have a <em>Circles</em> identity</a>, I don‚Äôt want to create a new one in my default <a href="https://www.sbt-ethereum.io/tasks/eth/shoebox/index.html" target="_blank" rel="noopener noreferrer"><em>sbt-ethereum</em> shoebox</a>. So I‚Äôll edit my <code>build.sbt</code> to use an empty, throwaway shoebox. <strong>You probably don‚Äôt want to do this! You should make your own identity to keep, in your default <em>sbt-ethereum</em> shoebox!</strong></p><p>Since we‚Äôll be working on the xDAI chain (chain ID 100), we‚Äôll also make that the default chain for this project. That‚Äôs only a convenience. We can always switch to xDAI by typing <code>ethNodeChainIdOverride 100</code>.</p><p>Anyway, here‚Äôs my edited <code>build.sbt</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">name := &quot;circles-tutorial&quot; </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">version := &quot;0.0.1-SNAPSHOT&quot;                    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ethcfgNodeChainId := 100 // you probably want this </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ethcfgShoeboxDirectory := &quot;throwaway-shoebox&quot; // you probably DON&#x27;T want this! keep your work</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="startup-sbt-ethereum"></a>Startup sbt-ethereum<a class="hash-link" href="#startup-sbt-ethereum" title="Direct link to heading">#</a></h3><p>From inside the <code>circles-tutorial</code> directory‚Ä¶</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sbt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] welcome to sbt 1.3.13 (Oracle Corporation Java 11.0.3)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading settings for project global-plugins from dependency-graph.sbt,metals.sbt,gpg.sbt ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading global plugins from /Users/swaldman/.sbt/1.0/plugins</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] There may be incompatibilities among your library dependencies; run &#x27;evicted&#x27; to see detailed eviction warnings.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading settings for project circles-tutorial-build-build from security.sbt ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading project definition from /Users/swaldman/circles-tutorial/project/project</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] There may be incompatibilities among your library dependencies; run &#x27;evicted&#x27; to see detailed eviction warnings.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading settings for project circles-tutorial-build from security.sbt,plugins.sbt ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading project definition from /Users/swaldman/circles-tutorial/project</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] There may be incompatibilities among your library dependencies; run &#x27;evicted&#x27; to see detailed eviction warnings.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mar 20, 2021 9:12:54 PM com.mchange.v2.log.MLog </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INFO: MLog clients using java 1.4+ standard logging with redirectable loggers.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] loading settings for project circles-tutorial from build.sbt ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] set current project to circles-tutorial (in build file:/Users/swaldman/circles-tutorial/)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">There are no wallets in the sbt-ethereum keystore. Would you like to generate one? [y/n] n</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] No wallet created. To create one, try &#x27;ethKeystoreWalletV3Create&#x27;, &#x27;ethKeystoreFromJsonImport&#x27;, or &#x27;ethKeystoreFromPrivateKeyImport&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">The current default solidity compiler [&#x27;0.7.6&#x27;] is not installed. Install? [y/n] n</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Updating available solidity compiler set.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] sbt-ethereum-0.5.3 successfully initialized (built Thu, 18 Mar 2021 19:46:19 -0400)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]  + shoebox directory: &#x27;/Users/swaldman/circles-tutorial/throwaway-shoebox&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Because I‚Äôm using a fresh, empty shoebox, sbt-ethereum asked if I wanted to generate a wallet address or download a solidity compiler. We will want to generate a wallet address, but we‚Äôll do it explicitly, since readers may not be prompted to create one on startup. Let‚Äôs do that!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-a-wallet-for-our-circles-identity"></a>Create a wallet for our Circles identity<a class="hash-link" href="#create-a-wallet-for-our-circles-identity" title="Direct link to heading">#</a></h2><p>We‚Äôll use the task <a href="https://www.sbt-ethereum.io/blog/2021/03/23/ethKeystoreWalletV3Create" target="_blank" rel="noopener noreferrer"><code>ethKeystoreWalletV3Create</code></a>. I‚Äôm going to call this identity ‚Äúcircles-snoopy‚Äù, because it ain‚Äôt me babe! It‚Äôs just a throwaway identity for this tutorial. If you are making an identity to keep, you might use your own name rather than ‚Äúsnoopy‚Äù.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethKeystoreWalletV3Create</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Generated keypair for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Generating V3 wallet, algorithm=scrypt, n=262144, r=8, p=1, dklen=32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Enter passphrase for new wallet: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Please retype to confirm: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Wallet generated into sbt-ethereum shoebox: &#x27;throwaway-shoebox&#x27;. Please backup, via &#x27;ethShoeboxBackup&#x27; or manually.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Consider validating the wallet using &#x27;ethKeystoreWalletV3Validate 0xB157256Af409007d903B443349bf49A9D6a1f519&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Would you like to define an alias for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (on chain with ID 100)? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Please enter an alias for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (on chain with ID 100): circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Alias &#x27;circles-snoopy&#x27; now points to address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (for chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 104 s (01:44), completed Mar 20, 2021, 9:23:27 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><em>Note: Scroll right to see the part where we entered in the alias circles-snoopy.</em></p><p>Cool.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prepare-to-work-with-the-circles-hub"></a>Prepare to work with the Circles hub<a class="hash-link" href="#prepare-to-work-with-the-circles-hub" title="Direct link to heading">#</a></h2><p><em>Circles‚Äò</em> core contract is the hub, which is on the xDAI chain at address <code>0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</code>. Let‚Äôs use <a href="https://www.sbt-ethereum.io/tasks/eth/address/alias.html#ethaddressaliasset" target="_blank" rel="noopener noreferrer"><code>ethAddressAliasSet</code></a> to give that an alias:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressAliasSet circles-hub 0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Alias &#x27;circles-hub&#x27; now points to address &#x27;0x29b9a7fBb8995b2423a71cC17cf9810798F6C543&#x27; (for chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 9:30:46 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Notice that address aliased are scoped to the Chain ID. Make sure that your output includes the <code>for chain with ID 100</code>, the xDAI chain. If you are on the wrong chain, you can drop the alias with <a href="https://www.sbt-ethereum.io/tasks/eth/address/alias.html#ethaddressaliasdrop" target="_blank" rel="noopener noreferrer"><code>ethAddressAliasDrop</code></a>, switch to the xDAI chain with <code>ethNodeChainIdOverride 100</code>, and rerun the command.</p><p>Before we can interact with <code>circles-hub</code> we‚Äôll need to import its ABI. When we‚Äôre working on the Ethereum main chain, we can often <a href="https://www.sbt-ethereum.io/tutorials/using-a-smart-contract-i.html#automatically-acquiring-an-abi-from-optional-" target="_blank" rel="noopener noreferrer">automatically import ABIs from Etherscan</a>. We can‚Äôt do that for contracts on the xDAI blockchain. Instead, we browse the xDAI Blockscout to find the <a href="https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts" target="_blank" rel="noopener noreferrer">verified contract ABI</a>, and let <em>sbt-ethereum</em> scrape the from the page (a new sbt-ethereum 0.5.3 feature!):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethContractAbiImport circles-hub</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] stack trace is suppressed; run last Compile / xethInvokerContext for the full output</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] (Compile / xethInvokerContext) com.mchange.sc.v1.sbtethereum.package$InvokerContextNotAvailableException: Could not instantiate an Invoker context. Please ensure that you have a node URL defined for the current chain ID. Try &#x27;eth&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] Total time: 0 s, completed Mar 20, 2021, 9:44:22 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Oopsie! The important bit there was <code>Please ensure that you have a node URL defined for the current chain ID. Try &#x27;eth&#x27;.</code></p><p>Since I‚Äôm working with a fresh environment (shoebox) that has never interacted with the xDAI chain, I need to define the URL to a node‚Äôs JSON-RPC service! Let‚Äôs do that:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethNodeUrlDefaultSet https://rpc.xdaichain.com/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Successfully set default node json-rpc URL for chain with ID 100 to https://rpc.xdaichain.com/.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 9:48:14 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Cool. Our error suggested we type <a href="https://www.sbt-ethereum.io/tasks/eth/index.html" target="_blank" rel="noopener noreferrer"><code>eth</code></a> to check out our environment. Let‚Äôs do that.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; eth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The session is now active on chain with ID 100, with node URL &#x27;https://rpc.xdaichain.com/&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] There is no sender available for the current session.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] Consider using &#x27;ethAddressSenderDefaultSet&#x27; or &#x27;ethAddressSenderOverrideSet&#x27; to define one.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current default gas price according to your node is 1 gwei. (THIS MAY CHANGE AT ANY TIME.)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 9:51:26 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>We‚Äôre advised to set a sender for our session. Let‚Äôs do that to. In my case, working from a fresh environment, I‚Äôll just make <code>circles-snoopy</code> the default sender with <a href="https://www.sbt-ethereum.io/tasks/eth/address/sender.html#ethaddresssenderdefaultset" target="_blank" rel="noopener noreferrer"><code>ethAddressSenderDefaultSet</code></a>. If you already have a default sender set-up for xDAI, and want to keep it, you can temporarily override it for this session with either <a href="https://www.sbt-ethereum.io/tasks/eth/address/sender.html#ethaddresssenderoverrideset" target="_blank" rel="noopener noreferrer"><code>ethAddressSenderOverrideSet</code></a> or [<code>ethAddressSenderOverride</code>)(<a href="https://www.sbt-ethereum.io/tasks/eth/address/sender.html#ethaddresssenderoverride" target="_blank" rel="noopener noreferrer">https://www.sbt-ethereum.io/tasks/eth/address/sender.html#ethaddresssenderoverride</a>). (The two are synonyms.) Anyway, you do you. Here‚Äôs me:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressSenderDefaultSet circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Successfully set default sender address for chain with ID 100 to &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] You can use the synthetic alias &#x27;default-sender&#x27; to refer to this address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 9:55:47 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Let‚Äôs check out our environment again with <a href="https://www.sbt-ethereum.io/tasks/eth/index.html" target="_blank" rel="noopener noreferrer"><code>eth</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; eth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The session is now active on chain with ID 100, with node URL &#x27;https://rpc.xdaichain.com/&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current session sender is &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current default gas price according to your node is 2 gwei. (THIS MAY CHANGE AT ANY TIME.)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 9:58:17 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Okay. Anyway, let‚Äôs try importing the contract ABI again. Remember, we can find the ABI embedded in the URL <a href="https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts" target="_blank" rel="noopener noreferrer">https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts</a></p><p>Importing the ABI will be very little work, but will yield a <strong><em>very</em></strong> long output. You can expand below to view it!</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethContractAbiImport circles-hub</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">To import an ABI, you may provide the JSON ABI directly, or else a file path or URL from which the ABI can be downloaded.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Contract ABI or Source: https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Attempting to interactively import a contract ABI.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Checking to see if you have provided a JSON array or object directly.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The provided text does not appear to be a JSON ABI.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Checking if the provided source exists as a File.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] No file found. Checking if the provided source is interpretable as a URL.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Interpreted user-provided source as a URL. Attempting to fetch contents.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">We can attempt to SCRAPE a unique ABI from the text of the provided source.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Be sure you trust &#x27;https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts&#x27; to contain a reliable representation of the ABI.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scrape for the ABI? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] No ABI was discovered in the raw bytes downloaded from &#x27;https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts&#x27;.ircles-tutorial / Compile / ethContractAbiImport 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Retrying, after unescaping as HTML.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] We had to scrape, but we were able to recover a unique ABI from source &#x27;https://blockscout.com/poa/xdai/address/0x29b9a7fBb8995b2423a71cC17cf9810798F6C543/contracts&#x27;!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Ready to import the following ABI:</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><details><summary><i>Show ABI</i></summary><div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;constructor&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;, / Compile / ethContractAbiImport 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_inflation&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_period&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_symbol&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;string&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_name&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;string&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_signupBonus&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_initialIssuance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_timeout&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;event&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;HubTransfer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;from&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;to&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;amount&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;anonymous&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;event&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;OrganizationSignup&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;organization&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;anonymous&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;event&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;Signup&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;user&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;token&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;anonymous&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;event&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;Trust&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;canSendTo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;user&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;limit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;anonymous&quot; : false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;checkSendLimit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;tokenOwner&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;src&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;dest&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;deployedAt&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;divisor&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;inflate&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_initial&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_periods&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;inflation&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;initialIssuance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;issuance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;issuanceByStep&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_periods&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;limits&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;string&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;name&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;organizationSignup&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;organizations&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;period&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;periods&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;pure&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;pow&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;base&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;exponent&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;seen&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;signup&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;signupBonus&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;string&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;symbol&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;timeout&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;tokenToUser&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;transferThrough&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address[]&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;tokenOwners&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address[]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address[]&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;srcs&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address[]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address[]&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;dests&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address[]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256[]&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;wads&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256[]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;trust&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;user&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;limit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;contract Token&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;userToToken&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;seen&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;sent&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;received&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;validation&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} ]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></details><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Do you wish to import this ABi? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] A default ABI is now known for the contract at address 0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 111 s (01:51), completed Mar 20, 2021, 10:05:27 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Looks good. Let‚Äôs see if we can read stuff from the contract.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionView circles-hub &lt;tab&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">checkSendLimit    deployedAt        divisor           inflate           inflation         initialIssuance   issuance          issuanceByStep    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">limits            name              organizations     period            periods           pow               seen              signupBonus       </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">symbol            timeout           tokenToUser       userToToken       validation        ‚Äã                  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionView circles-hub period</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The function &#x27;period&#x27; yields 1 result.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]  + Result 1 of type &#x27;uint256&#x27; is 31556952</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:08:17 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Yes we can!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="fund-our-circles-identity"></a>Fund our Circles identity<a class="hash-link" href="#fund-our-circles-identity" title="Direct link to heading">#</a></h2><p>This is the part that will require a bit of help from outside this tutorial. Our new identity (<code>circles-snoopy</code> in my case) will want to call the <code>signup</code> method on the <em>Circles</em> hub. But we can‚Äôt call methods that modify the blockchain unless we have ‚Äúether‚Äù (xDAI on the xDAI chain) with which to pay for gas. First, let‚Äôs checkout our identity‚Äôs current balance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressBalance circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0 ether (as of the latest incorporated block, address 0xB157256Af409007d903B443349bf49A9D6a1f519)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(The USD value of this is unknown, no exchange value is currently available for chain with ID 100 from Coinbase.)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:13:27 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>We‚Äôre broke. So now we‚Äôll have to find a friend, try the <a href="https://www.xdaichain.com/for-users/get-xdai-tokens/xdai-faucet" target="_blank" rel="noopener noreferrer">semi-abandoned faucet</a>, or <a href="https://www.sbt-ethereum.io/blog/2021/02/20/Converting-DAI-to-xDAI-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">use the DAI-to-xDAI bridge to get some funds</a>. Feel free to <a href="mailto:swaldman@mchange.com" target="_blank" rel="noopener noreferrer">hit me up</a> for the few cents you‚Äôll need. I‚Äôll send myself a few cents worth of xDAI from elsewhere, then recheck my balance.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressBalance circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0.1 ether (as of the latest incorporated block, address 0xB157256Af409007d903B443349bf49A9D6a1f519)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(The USD value of this is unknown, no exchange value is currently available for chain with ID 100 from Coinbase.)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:18:15 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>We have ca$h!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sign-up-for-circles-as-our-new-identity"></a>Sign up for Circles as our new identity<a class="hash-link" href="#sign-up-for-circles-as-our-new-identity" title="Direct link to heading">#</a></h2><p>Now that <code>circles-snoopy</code> is funded we can sign up. We‚Äôve already made this address our default sender, but you may not have, so let‚Äôs make sure that account our session sender using <a href="https://www.sbt-ethereum.io/tasks/eth/address/sender.html#ethaddresssenderoverride" target="_blank" rel="noopener noreferrer"><code>ethAddressSenderOverride</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressSenderOverride circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Sender override set to &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (on chain with ID 100, aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;])).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:23:21 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Okay. Now let‚Äôs sign up with the hub.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionInvoke circles-hub signup</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; T R A N S A C T I O N   S I G N A T U R E   R E Q U E S T</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The transaction would be a message with...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   To:    0x29b9a7fBb8995b2423a71cC17cf9810798F6C543 (with aliases [&#x27;circles-hub&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   From:  0xB157256Af409007d903B443349bf49A9D6a1f519 (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Data:  0xb7bc0f73 / Compile / ethTransactionInvoke 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Value: 0 ether</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; According to the ABI currently associated with the &#x27;to&#x27; address, this message would amount to the following method call...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Function called: signup()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The nonce of the transaction would be 0.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ The transaction you have requested could use up to 1497631 units of gas.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ You would pay 20 gwei for each unit of gas, for a maximum cost of 0.02995262 ether.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ (No USD value could be determined for ETH on chain with ID 100 from Coinbase).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Would you like to sign this transaction? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Unlocking address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Enter passphrase or hex private key for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27;: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Called function &#x27;signup&#x27;, with args &#x27;&#x27;, sending 0 wei to address &#x27;0x29b9a7fBb8995b2423a71cC17cf9810798F6C543&#x27; in transaction with hash &#x27;0x0ed96eff6caeeb3c92896bfd77165b2ad5349b91e5b6126c1baf7baf3a208451&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Waiting for the transaction to be mined (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] stack trace is suppressed; run last Compile / ethTransactionInvoke for the full output</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] (Compile / ethTransactionInvoke) com.mchange.sc.v1.consuela.ethereum.jsonrpc.package$ClientException: Block information is incomplete while ancient block sync is still in progress, before it&#x27;s finished we can&#x27;t determine the existence of requested item. -- errorCode=-32000; methodName=eth_getTransactionReceipt; params=List(&quot;0x0ed96eff6caeeb3c92896bfd77165b2ad5349b91e5b6126c1baf7baf3a208451&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] Total time: 26 s, completed Mar 20, 2021, 10:25:03 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Uh-oh. Some weird shit happened there. We successfully submitted the transaction, but while we were waiting for a transaction receipt to prove it had been mined, <a href="https://github.com/openethereum/parity-ethereum/issues/10777" target="_blank" rel="noopener noreferrer">some Parity/openethereum-client thing went wrong</a>. We have the transaction hash, <code>0x0ed96eff6caeeb3c92896bfd77165b2ad5349b91e5b6126c1baf7baf3a208451</code>. (Scroll all the way to the right to see it.) We can manually check for the transaction receipt to see how our signup attempt turned out using <a href="https://github.com/openethereum/parity-ethereum/issues/10777" target="_blank" rel="noopener noreferrer"><code>ethTransactionLookup</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionLookup 0x0ed96eff6caeeb3c92896bfd77165b2ad5349b91e5b6126c1baf7baf3a208451</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Looking up transaction &#x27;0x0ed96eff6caeeb3c92896bfd77165b2ad5349b91e5b6126c1baf7baf3a208451&#x27; (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Transaction Receipt:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Hash:    0x0ed96eff6caeeb3c92896bfd77165b2ad5349b91e5b6126c1baf7baf3a208451</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Index:   3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Status:  SUCCEEDED</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Hash:          0xf8d6258f8a889981818eff16d8a88acd0fa03973c7e396f08b35edf1be9e62e2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Number:        15117319</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        From:                0xB157256Af409007d903B443349bf49A9D6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        To:                  0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Cumulative Gas Used: 2901510</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Gas Used:            1227346</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Contract Address:    None</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Logs:                0 =&gt; EthLogEntry [source=0xf910549FdbA1083B7E515029601e8Bc748774C64] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x0000000000000000000000000000000000000000000000000000000000000000,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=000000000000000000000000000000000000000000000002b5e3af16b1880000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  ),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                             1 =&gt; EthLogEntry [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0xe60c754dd8ab0b1b5fccba257d6ebcd7d09e360ab7dd7a6e58198ca1f57cdcec,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=0000000000000000000000000000000000000000000000000000000000000064</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  ),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                             2 =&gt; EthLogEntry [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x358ba8f768af134eb5af120e9a61dc1ef29b29f597f047b555fc3675064a0342,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=000000000000000000000000f910549fdba1083b7e515029601e8bc748774c64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Events:              0 =&gt; Anonymous Event [source=0xf910549FdbA1083B7E515029601e8Bc748774C64],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                             1 =&gt; Trust [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    canSendTo (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    user (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    limit (of type uint256): 100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  ),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                             2 =&gt; Signup [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    user (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    token (of type address): 0xf910549FdbA1083B7E515029601e8Bc748774C64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 3 s, completed Mar 20, 2021, 10:32:51 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Our signup did succeed! Notice a ‚Äútrust‚Äù event also occurred. If we look at the <a href="https://www.sbt-ethereum.io/blog/2021/03/23/Circles-with-sbt-ethereum-II-Circles-by-hand-redux.html#Appendix-Circles-hub-source-code" target="_blank" rel="noopener noreferrer">hub source code</a>, we‚Äôll see that as part of the signup process, we trust ourselves 100%!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="working-with-our-me-coin"></a>Working with our ‚Äúme-coin‚Äù<a class="hash-link" href="#working-with-our-me-coin" title="Direct link to heading">#</a></h2><p>Looking at the transaction above, we can see in the <code>Signup</code> event the address of our new ERC-20 token contract, <code>0xf910549FdbA1083B7E515029601e8Bc748774C64</code>. We can also find the address of our token by accessing the <code>userToToken</code> mapping:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionView circles-hub userToToken circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The function &#x27;userToToken&#x27; yields 1 result.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]  + Result 1 of type &#x27;address&#x27; is 0xf910549FdbA1083B7E515029601e8Bc748774C64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:38:58 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>They agree! Let‚Äôs give our new token an alias. Usually I alias ERC-20 tokens by their self-reported symbols. For <em>Circles</em> tokens, every user‚Äôs token advertises the symbol CRC. So we‚Äôll call our new token <code>CRC-snoopy</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressAliasSet CRC-snoopy 0xf910549FdbA1083B7E515029601e8Bc748774C64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Alias &#x27;CRC-snoopy&#x27; now points to address &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (for chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:42:25 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>That should be an ERC-20 token, so let‚Äôs use sbt-ethereum‚Äòs built-in <a href="https://www.sbt-ethereum.io/tasks/erc20.html#erc20summary" target="_blank" rel="noopener noreferrer"><code>erc20Summary</code></a> task to check it out.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Summary CRC-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] ERC20 Summary, token contract at &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   Self-Reported Name:   Circles</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   Self-Reported Symbol: CRC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   Decimals:             18</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   Total Supply:         50 tokens (50000000000000000000 atoms)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:43:24 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Looks good!</p><p>Let‚Äôs check our own balance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Balance CRC-snoopy circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] For ERC20 Token Contract &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100), with 18 decimals...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   For Address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100))...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]     Balance: 50 tokens (which corresponds to 50000000000000000000 atoms)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>We own all 50 of the current total supply. We‚Äôre rich!</p><p>This should be a perfectly normal ERC-20 token. It will have some special functionality ‚Äî most importantly an <code>update</code> method through which the token owner, <code>circles-token</code>, can receive its ‚ÄúUBI‚Äù, and the capacity to call <code>transferThrough</code> on the hub, which <a href="https://www.sbt-ethereum.io/blog/2021/03/14/Circles-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">restricts transfers according to trust relationships</a> and emits a special <code>HubTransfer</code> event. But we can use our new token just like a plain old ERC-20 too. Let‚Äôs give that a try. We should be able to send our token to an arbitrary Ethereum address. (Ideally one that we control, if we want our token back!):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Transfer CRC-snoopy 0x72a8a15ECa1f824ADE35cdEB2148223402f23448 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] For the ERC20 token with contract address &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100)...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn]   you would transfer 1 tokens, which (with 18 decimals) translates to 1000000000000000000 atoms.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] The transfer would be </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn]   From: &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn]   To:   &#x27;0x72a8a15ECa1f824ADE35cdEB2148223402f23448&#x27; (on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] You are calling the &#x27;transfer&#x27; function on the contract at &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] THIS FUNCTION COULD DO ANYTHING. </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] Make sure that you trust that the token contract does only what you intend, and carefully verify the transaction cost before approving the ultimate transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Continue? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; T R A N S A C T I O N   S I G N A T U R E   R E Q U E S T</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The transaction would be a message with...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   To:    0xf910549FdbA1083B7E515029601e8Bc748774C64 (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   From:  0xB157256Af409007d903B443349bf49A9D6a1f519 (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Data:  0xa9059cbb00000000000000000000000072a8a15eca1f824ade35cdeb2148223402f234480000000000000000000000000000000000000000000000000de0b6b3a7640000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Value: 0 ether</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; !!! Any ABI is associated with the destination address is currently unknown, so we cannot decode the message data as a method call !!!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The nonce of the transaction would be 1.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ The transaction you have requested could use up to 63421 units of gas.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ You would pay 20 gwei for each unit of gas, for a maximum cost of 0.00126842 ether.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ (No USD value could be determined for ETH on chain with ID 100 from Coinbase).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Would you like to sign this transaction? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Unlocking address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Enter passphrase or hex private key for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27;: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] ERC20 Transfer, Token Contract &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   --&gt; Sent 1 tokens (1000000000000000000 atoms)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   --&gt;   from &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   --&gt;   to &#x27;0x72a8a15ECa1f824ADE35cdEB2148223402f23448&#x27; (on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Waiting for the transaction to be mined (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Transaction Receipt:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Hash:    0xa44798d3f08ce87c84044784bc6cf8b18e4bac291f92bda0e85b8833808507ea</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Index:   2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Status:  SUCCEEDED</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Hash:          0x7aaaee8ed5c70583e7ec081c6388c699b8546e3013470817ff66770e3289baa9</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Number:        15117617</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        From:                0xB157256Af409007d903B443349bf49A9D6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        To:                  0xf910549FdbA1083B7E515029601e8Bc748774C64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Cumulative Gas Used: 1283692</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Gas Used:            51350</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Contract Address:    None</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Logs:                0 =&gt; EthLogEntry [source=0xf910549FdbA1083B7E515029601e8Bc748774C64] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x00000000000000000000000072a8a15eca1f824ade35cdeb2148223402f23448</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=0000000000000000000000000000000000000000000000000de0b6b3a7640000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Events:              0 =&gt; Transfer [source=0xf910549FdbA1083B7E515029601e8Bc748774C64] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    from (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    to (of type address): 0x72a8a15ECa1f824ADE35cdEB2148223402f23448,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    tokens (of type uint256): 1000000000000000000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 43 s, completed Mar 20, 2021, 10:49:59 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It seems to have worked! We‚Äôve sent one token from <code>circles-snoopy</code> (which owned all 50 of the initial supply) to <code>0x72a8a15ECa1f824ADE35cdEB2148223402f23448</code> (an address I control). We expect <code>circles-snoopy</code> to now have a balance of only 49 tokens, and <code>0x72a8a15ECa1f824ADE35cdEB2148223402f23448</code> to have a balance of one token. First let‚Äôs check circles-snoopy:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Balance CRC-snoopy circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] For ERC20 Token Contract &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100), with 18 decimals...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   For Address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100))...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]     Balance: 49 tokens (which corresponds to 49000000000000000000 atoms)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:55:17 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>49 tokens as expected! Now let‚Äôs check the balance of <code>0x72a8a15ECa1f824ADE35cdEB2148223402f23448</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Balance CRC-snoopy 0x72a8a15ECa1f824ADE35cdEB2148223402f23448</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] For ERC20 Token Contract &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100), with 18 decimals...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   For Address &#x27;0x72a8a15ECa1f824ADE35cdEB2148223402f23448&#x27; (on chain with ID 100))...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]     Balance: 1 tokens (which corresponds to 1000000000000000000 atoms)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:56:18 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>One token, also as expected. Yay!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="trust-trust-trust"></a>Trust trust trust<a class="hash-link" href="#trust-trust-trust" title="Direct link to heading">#</a></h2><p>My ‚Äúreal‚Äù circles identity is <code>0x647E68F4BCBC843F39c80bb02da96dD13308f657</code>. Let‚Äôs define an alias for that, <code>circles-steve</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethAddressAliasSet circles-steve 0x647E68F4BCBC843F39c80bb02da96dD13308f657</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Alias &#x27;circles-steve&#x27; now points to address &#x27;0x647E68F4BCBC843F39c80bb02da96dD13308f657&#x27; (for chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 20, 2021, 10:59:45 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The hub has a <code>trust</code> method that accepts an address and a limit (from 0 to 100, interpreted as degree of trust in the form of a percentage. Let‚Äôs trust that bastard steve 50%:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionInvoke circles-hub trust circles-steve 50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; T R A N S A C T I O N   S I G N A T U R E   R E Q U E S T</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The transaction would be a message with...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   To:    0x29b9a7fBb8995b2423a71cC17cf9810798F6C543 (with aliases [&#x27;circles-hub&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   From:  0xB157256Af409007d903B443349bf49A9D6a1f519 (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Data:  0x9951d62f000000000000000000000000647e68f4bcbc843f39c80bb02da96dd13308f6570000000000000000000000000000000000000000000000000000000000000032| =&gt; circles-tutorial / Compile / ethTransactionInvoke 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Value: 0 ether</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; According to the ABI currently associated with the &#x27;to&#x27; address, this message would amount to the following method call...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Function called: trust(address,uint256)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;     Arg 1 [name=user, type=address]: 0x647E68F4BCBC843F39c80bb02da96dD13308f657</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;     Arg 2 [name=limit, type=uint256]: 50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The nonce of the transaction would be 2.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ The transaction you have requested could use up to 57835 units of gas.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ You would pay 1 gwei for each unit of gas, for a maximum cost of 0.000057835 ether.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ (No USD value could be determined for ETH on chain with ID 100 from Coinbase).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Would you like to sign this transaction? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Unlocking address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Enter passphrase or hex private key for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27;: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Called function &#x27;trust&#x27;, with args &#x27;647e68f4bcbc843f39c80bb02da96dd13308f657, 50&#x27;, sending 0 wei to address &#x27;0x29b9a7fBb8995b2423a71cC17cf9810798F6C543&#x27; in transaction with hash &#x27;0x4b76f6fdfde76c2dbb26b790f9184e2315cb60f234b637337dd14ac219426f64&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Waiting for the transaction to be mined (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] stack trace is suppressed; run last Compile / ethTransactionInvoke for the full output</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] (Compile / ethTransactionInvoke) com.mchange.sc.v1.consuela.ethereum.jsonrpc.package$ClientException: Block information is incomplete while ancient block sync is still in progress, before it&#x27;s finished we can&#x27;t determine the existence of requested item. -- errorCode=-32000; methodName=eth_getTransactionReceipt; params=List(&quot;0x4b76f6fdfde76c2dbb26b790f9184e2315cb60f234b637337dd14ac219426f64&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[error] Total time: 18 s, completed Mar 20, 2021, 11:03:16 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Grrr. That <a href="https://github.com/openethereum/parity-ethereum/issues/10777" target="_blank" rel="noopener noreferrer">weird Parity/openethereum-client thing</a> occurred again, while we were waiting for a transaction receipt for transaction <code>0x4b76f6fdfde76c2dbb26b790f9184e2315cb60f234b637337dd14ac219426f64</code>. (Scroll all the way to the right to see this hash.) We again have to verify the mining of that transaction by hand, using <a href="https://www.sbt-ethereum.io/tasks/eth/transaction/index.html#ethtransactionlookup-transaction-hash-" target="_blank" rel="noopener noreferrer"><code>ethTransactionLookup</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionLookup 0x4b76f6fdfde76c2dbb26b790f9184e2315cb60f234b637337dd14ac219426f64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Looking up transaction &#x27;0x4b76f6fdfde76c2dbb26b790f9184e2315cb60f234b637337dd14ac219426f64&#x27; (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Transaction Receipt:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Hash:    0x4b76f6fdfde76c2dbb26b790f9184e2315cb60f234b637337dd14ac219426f64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Index:   9</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Status:  SUCCEEDED</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Hash:          0xa9fabeca7e7bd3b7f701cb7624faa76b6cac16bd70936143a0cbc0ca25f1e668</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Number:        15117777</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        From:                0xB157256Af409007d903B443349bf49A9D6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        To:                  0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Cumulative Gas Used: 5864451</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Gas Used:            46695</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Contract Address:    None</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Logs:                0 =&gt; EthLogEntry [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0xe60c754dd8ab0b1b5fccba257d6ebcd7d09e360ab7dd7a6e58198ca1f57cdcec,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000647e68f4bcbc843f39c80bb02da96dd13308f657</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=0000000000000000000000000000000000000000000000000000000000000032</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Events:              0 =&gt; Trust [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    canSendTo (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    user (of type address): 0x647E68F4BCBC843F39c80bb02da96dD13308f657,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    limit (of type uint256): 50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The transaction did succeed. We can verify that by checking the trust limit of <code>circles-snoopy</code> for <code>circles-steve</code> using <a href="https://www.sbt-ethereum.io/tasks/eth/transaction/index.html#ethtransactionview" target="_blank" rel="noopener noreferrer"><code>ethTransactionView</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionView circles-hub limits circles-snoopy circles-steve</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The function &#x27;limits&#x27; yields 1 result.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]  + Result 1 of type &#x27;uint256&#x27; is 50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 2 s, completed Mar 20, 2021, 11:09:17 PM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>As expected, it‚Äôs 50%. Which seems generous, considering.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="collecting-our-ubi"></a>Collecting our ‚ÄúUBI‚Äù<a class="hash-link" href="#collecting-our-ubi" title="Direct link to heading">#</a></h2><p>We let some time pass, and start a session in our <code>circles-tutorial</code> project. Let‚Äôs check <code>circles-snoopy</code>‚Äòs current balance of <code>CRC-snoopy</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Balance CRC-snoopy circles-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] For ERC20 Token Contract &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100), with 18 decimals...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   For Address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100))...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]     Balance: 49 tokens (which corresponds to 49000000000000000000 atoms)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 1 s, completed Mar 23, 2021, 12:02:20 AM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It‚Äôs the same as before, 49 tokens, we haven‚Äôt received any UBI yet. But wait! We‚Äôre not supposed to until we call an <code>update</code> method. (See the <a href="https://www.sbt-ethereum.io/blog/2021/03/23/Circles-with-sbt-ethereum-II-Circles-by-hand-redux.html#Appendix-Circles-hub-source-code" target="_blank" rel="noopener noreferrer">source code in the appendix</a>, which includes the token contract.)</p><p>Since <code>update()</code> is not a standard ERC-20 method, we‚Äôll need to import the ABI for <em>Circles</em>-specific tokens. We can find that <a href="https://github.com/CirclesUBI/circles-contracts/blob/master/build/contracts/Token.json" target="_blank" rel="noopener noreferrer">on the <em>Circles</em> github site</a>. As of sbt-ethereum 0.5.3, we can just provide the URL to ABI importing tasks (<a href="https://www.sbt-ethereum.io/tasks/eth/contract/abi.html#ethcontractabiimport" target="_blank" rel="noopener noreferrer"><code>ethContractAbiImport</code></a> and <a href="https://www.sbt-ethereum.io/tasks/eth/contract/abi.html#ethcontractabidefaultimport" target="_blank" rel="noopener noreferrer"><code>ethContractAbiDefaultImport</code></a>) and <em>sbt-ethereum</em> will extract the ABI.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethContractAbiImport CRC-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">To import an ABI, you may provide the JSON ABI directly, or else a file path or URL from which the ABI can be downloaded.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Contract ABI or Source: https://github.com/CirclesUBI/circles-contracts/blob/master/build/contracts/Token.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Attempting to interactively import a contract ABI.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Checking to see if you have provided a JSON array or object directly.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The provided text does not appear to be a JSON ABI.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Checking if the provided source exists as a File.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] No file found. Checking if the provided source is interpretable as a URL.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] &#x27;https://github.com/CirclesUBI/circles-contracts/blob/master/build/contracts/Token.json&#x27; was reinterpreted into raw URL &#x27;https://raw.githubusercontent.com/CirclesUBI/circles-contracts/master/build/contracts/Token.json. Trying that, will retry provided URL if necessary.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Interpreted user-provided source as a URL. Attempting to fetch contents.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Found JSON object. Will look for an ABI under the key &#x27;abi&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The data discovered at source &#x27;https://github.com/CirclesUBI/circles-contracts/blob/master/build/contracts/Token.json&#x27; was successfully interpreted as an ABI.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Ready to import the following ABI:</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><details><summary><i>Show ABI</i></summary><div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;_owner&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;l / Compile / ethContractAbiImport 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;constructor&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;anonymous&quot; : false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;owner&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;spender&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;value&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;Approval&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;event&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;anonymous&quot; : false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;from&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;to&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;indexed&quot; : false,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;value&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;Transfer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;event&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;owner&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;spender&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;allowance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;spender&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;amount&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;approve&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;account&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;balanceOf&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;currentIssuance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;decimals&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint8&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint8&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;spender&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;subtractedValue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;decreaseAllowance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;hub&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;spender&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;addedValue&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;increaseAllowance&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;inflationOffset&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;lastTouched&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;owner&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;totalSupply&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;sender&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;recipient&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;amount&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;transferFrom&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;time&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;symbol&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;string&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;name&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;string&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;period&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;periods&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;timeout&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;periodsWhenLastTouched&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;hubDeployedAt&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;stop&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;stopped&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;findInflationOffset&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;look&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;view&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;update&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;from&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;to&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;amount&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;hubTransfer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;address&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;dst&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;address&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;uint256&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;wad&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;uint256&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot; : &quot;transfer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot; : [ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;internalType&quot; : &quot;bool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot; : &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;type&quot; : &quot;bool&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;stateMutability&quot; : &quot;nonpayable&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot; : &quot;function&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} ]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></details><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Do you wish to import this ABi? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] A default ABI is now known for the contract at address 0xf910549FdbA1083B7E515029601e8Bc748774C64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 7 s, completed Mar 23, 2021, 12:06:23 AM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now we can see and use methods that are not standard to ERC-20 tokens. We can check-out the read-only methods with <a href="https://www.sbt-ethereum.io/tasks/eth/transaction/index.html#ethtransactionview" target="_blank" rel="noopener noreferrer"><code>ethTransactionView</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionView CRC-snoopy &lt;tab&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">allowance                balanceOf                currentIssuance          decimals                 findInflationOffset      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">hub                      hubDeployedAt            inflationOffset          lastTouched              look                     </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">name                     owner                    period                   periods                  periodsWhenLastTouched   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">stopped                  symbol                   time                     timeout                  totalSupply              </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>We can also check-out the methods that would modiy the blockchain and should be run in a transaction with <a href="https://www.sbt-ethereum.io/tasks/eth/transaction/index.html#ethtransactioninvoke" target="_blank" rel="noopener noreferrer"><code>ethTransactionInvoke</code></a></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionInvoke CRC-snoopy &lt;tab&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">approve             decreaseAllowance   hubTransfer         increaseAllowance   stop                transfer            transferFrom        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">update              ‚Äã                    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If we look at the h<a href="https://www.sbt-ethereum.io/blog/2021/03/23/(#Appendix-Circles-hub-source-code)" target="_blank" rel="noopener noreferrer">ub source code</a> (which includes the source code for the <em>Circles</em> tokens it produces), we‚Äôll learn that the read-only <code>look</code> method tells us how much ‚ÄúUBI‚Äù a <em>Circles</em> token in surrently entitled to, while the blockchain-modifying <code>update</code> method actually delivers the new tokens. Let‚Äôs try them out. First let‚Äôs call look:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionView CRC-snoopy look</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The function &#x27;look&#x27; yields 1 result.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]  + Result 1 of type &#x27;uint256&#x27; is 16646759259259152720</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 23, 2021, 12:21:33 AM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Since <code>CRC-snoopy</code> is an <a href="https://eips.ethereum.org/EIPS/eip-20" target="_blank" rel="noopener noreferrer">ERC-20 token with the standard 18 <code>decimals()</code></a>, this will correspond to 16.67 tokens.</p><p>Now let‚Äôs go ahead and call the blockchain-modifying function <code>update</code> in a trasaction:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; ethTransactionInvoke CRC-snoopy update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; T R A N S A C T I O N   S I G N A T U R E   R E Q U E S T</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The transaction would be a message with...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   To:    0xf910549FdbA1083B7E515029601e8Bc748774C64 (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   From:  0xB157256Af409007d903B443349bf49A9D6a1f519 (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Data:  0xa2e62045</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Value: 0 etherial / Compile / ethTransactionInvoke 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; According to the ABI currently associated with the &#x27;to&#x27; address, this message would amount to the following method call...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Function called: update()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The nonce of the transaction would be 3.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ The transaction you have requested could use up to 90590 units of gas.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ You would pay 10 gwei for each unit of gas, for a maximum cost of 0.0009059 ether.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ (No USD value could be determined for ETH on chain with ID 100 from Coinbase).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Would you like to sign this transaction? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Unlocking address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Enter passphrase or hex private key for address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27;: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Called function &#x27;update&#x27;, with args &#x27;&#x27;, sending 0 wei to address &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; in transaction with hash &#x27;0x70acc6f45712f2b5e8ab7c2e052a22fa70df2d8c484751ddd1a4d873606e977b&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Waiting for the transaction to be mined (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Transaction Receipt:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Hash:    0x70acc6f45712f2b5e8ab7c2e052a22fa70df2d8c484751ddd1a4d873606e977b</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Index:   1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Status:  SUCCEEDED</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Hash:          0xc5e83a56b6d8cb49f6d2d32b11c64bfc48632cd21f57804422826368a881067c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Number:        15152993</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        From:                0xB157256Af409007d903B443349bf49A9D6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        To:                  0xf910549FdbA1083B7E515029601e8Bc748774C64</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Cumulative Gas Used: 1003680</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Gas Used:            73924</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Contract Address:    None</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Logs:                0 =&gt; EthLogEntry [source=0xf910549FdbA1083B7E515029601e8Bc748774C64] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x0000000000000000000000000000000000000000000000000000000000000000,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=000000000000000000000000000000000000000000000000e7663606ffbaab00</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Events:              0 =&gt; Transfer [source=0xf910549FdbA1083B7E515029601e8Bc748774C64] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    from (of type address): 0x0000000000000000000000000000000000000000,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    to (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    value (of type uint256): 16674074074073967360</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 40 s, completed Mar 23, 2021, 12:26:28 AM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Excellent. It looks like it succeeded. Now let‚Äôs check <code>CRC-snoopy</code>‚Äòs balance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:circles-tutorial&gt; erc20Balance CRC-snoopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] For ERC20 Token Contract &#x27;0xf910549FdbA1083B7E515029601e8Bc748774C64&#x27; (with aliases [&#x27;CRC-snoopy&#x27;] on chain with ID 100), with 18 decimals...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]   For Address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (with aliases [&#x27;circles-snoopy&#x27;,&#x27;default-sender&#x27;] on chain with ID 100))...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]     Balance: 65.67407407407396736 tokens (which corresponds to 65674074074073967360 atoms)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 1 s, completed Mar 23, 2021, 12:28:24 AM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It‚Äôs been credited with the expected additional 16.67 tokens. Yay UBI!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-transferthrough-to-make-a-hub-transfer"></a>Using <code>transferThrough</code> to make a ‚Äúhub transfer‚Äù<a class="hash-link" href="#using-transferthrough-to-make-a-hub-transfer" title="Direct link to heading">#</a></h2><p>You can send your <em>Circles</em> tokens to any <em>Ethereum</em> address. You can receive <em>Circles</em> tokens from any <em>Ethereum</em> address. But given how easy it is to create a new identity endowed with <em>Circles</em> tokens, if someone sends you some random <em>Circles</em> tokens, you shouldn‚Äôt feel very much obliged to provide some form of value to reciprocate for the value received.</p><p>However, if you receive tokens from an address that you‚Äôve trusted, directly or indirectly according to the rules of the <em>Circles</em> app, then you are arguably duty bound to treat those tokens as if they were as valuable as your own, so <a href="https://www.sbt-ethereum.io/blog/2021/03/14/Circles-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">to provide value or perform a favor as if the payer had redeemed one of your own tokens</a>.</p><p>If you wish to pay a <em>Circles</em> participant in a way that makes clear that your token is trusted and should be honored, you can perform a <em>hub transfer</em>. When you do so, you specify the <a href="https://www.sbt-ethereum.io/blog/2021/03/14/Circles-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">trust path</a> through which your tokens will travel, and the transfer will only succeed if the hub smart contract can validate that path.</p><p>In this tutorial, the identity <code>circles-snoopy</code> trusted my real identity <code>circles-steve (0x647E68F4BCBC843F39c80bb02da96dD13308f657)</code>.</p><p>From my main environment (rather than the temporary shoebox I‚Äôve used for this exercise), I call <code>transferThrough</code>beginning with my own <em>Circles</em> tokens, ending with <code>circles-snoopy</code>, generating a hub transfer event. The syntax will be a bit arcane, though. And note the different environment we‚Äôre in, different project, different sender, different aliases. (<code>circles-steve</code> is <code>circles-identity</code> here; <code>circles-hub</code> is <code>gnosis-circles-hub</code>.)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:eth-command-line&gt; ethNodeChainIdOverride 100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The chain ID has been overridden to 100.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The session is now active on chain with ID 100, with node URL &#x27;https://rpc.xdaichain.com/&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current session sender is &#x27;0x72a8a15ECa1f824ADE35cdEB2148223402f23448&#x27; (with aliases [&#x27;default-sender&#x27;,&#x27;testing-xDAI&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current default gas price according to your node is 20 gwei. (THIS MAY CHANGE AT ANY TIME.)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 1 s, completed Mar 23, 2021, 12:50:00 AM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:eth-command-line&gt; ethAddressSenderOverride circles-identity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Sender override set to &#x27;0x647E68F4BCBC843F39c80bb02da96dD13308f657&#x27; (on chain with ID 100, aliases [&#x27;circles-identity&#x27;])).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 23, 2021, 12:50:17 AM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:eth-command-line&gt; eth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The session is now active on chain with ID 100, with node URL &#x27;https://rpc.xdaichain.com/&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current session sender is &#x27;0x647E68F4BCBC843F39c80bb02da96dD13308f657&#x27; (with aliases [&#x27;circles-identity&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] The current default gas price according to your node is 20 gwei. (THIS MAY CHANGE AT ANY TIME.)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[warn] NOTE: The sender has been overridden to &#x27;0x647E68F4BCBC843F39c80bb02da96dD13308f657&#x27; (with aliases [&#x27;circles-identity&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 23, 2021, 12:50:22 AM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:eth-command-line&gt; ethAddressAliasSet circles-snoopy 0xB157256Af409007d903B443349bf49A9D6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Alias &#x27;circles-snoopy&#x27; now points to address &#x27;0xB157256Af409007d903B443349bf49A9D6a1f519&#x27; (for chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Refreshing caches.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 0 s, completed Mar 23, 2021, 12:51:45 AM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt:eth-command-line&gt; ethTransactionInvoke gnosis-circles-hub transferThrough [0x647E68F4BCBC843F39c80bb02da96dD13308f657] [0x647E68F4BCBC843F39c80bb02da96dD13308f657] [0xB157256Af409007d903B443349bf49A9D6a1f519] [1000000000000000000]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; T R A N S A C T I O N   S I G N A T U R E   R E Q U E S T</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The transaction would be a message with...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   To:    0x29b9a7fBb8995b2423a71cC17cf9810798F6C543 (with aliases [&#x27;gnosis-circles-hub&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   From:  0x647E68F4BCBC843F39c80bb02da96dD13308f657 (with aliases [&#x27;circles-identity&#x27;] on chain with ID 100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Data:  0xd62fd9a2000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000647e68f4bcbc843f39c80bb02da96dd13308f6570000000000000000000000000000000000000000000000000000000000000001000000000000000000000000647e68f4bcbc843f39c80bb02da96dd13308f6570000000000000000000000000000000000000000000000000000000000000001000000000000000000000000b157256af409007d903b443349bf49a9d6a1f51900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000de0b6b3a7640000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Value: 0 ether</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; According to the ABI currently associated with the &#x27;to&#x27; address, this message would amount to the following method call...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;   Function called: transferThrough(address[],address[],address[],uint256[])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;     Arg 1 [name=tokenOwners, type=address[]]: [0x647E68F4BCBC843F39c80bb02da96dD13308f657]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;     Arg 2 [name=srcs, type=address[]]: [0x647E68F4BCBC843F39c80bb02da96dD13308f657]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;     Arg 3 [name=dests, type=address[]]: [0xB157256Af409007d903B443349bf49A9D6a1f519]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;     Arg 4 [name=wads, type=uint256[]]: [1000000000000000000]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; The nonce of the transaction would be 8.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ The transaction you have requested could use up to 317089 units of gas.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ You would pay 20 gwei for each unit of gas, for a maximum cost of 0.00634178 ether.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; $$$ (No USD value could be determined for ETH on chain with ID 100 from Coinbase).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Would you like to sign this transaction? [y/n] y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Unlocking address &#x27;0x647E68F4BCBC843F39c80bb02da96dD13308f657&#x27; (with aliases [&#x27;circles-identity&#x27;] on chain with ID 100).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Enter passphrase or hex private key for address &#x27;0x647E68F4BCBC843F39c80bb02da96dD13308f657&#x27;: ************************</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Called function &#x27;transferThrough&#x27;, with args &#x27;[0x647E68F4BCBC843F39c80bb02da96dD13308f657], [0x647E68F4BCBC843F39c80bb02da96dD13308f657], [0xB157256Af409007d903B443349bf49A9D6a1f519], [1000000000000000000]&#x27;, sending 0 wei to address &#x27;0x29b9a7fBb8995b2423a71cC17cf9810798F6C543&#x27; in transaction with hash &#x27;0x19df802de1068e648f55b949a38f5516f5a824684ae884534d65b31b5b0a9edc&#x27;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Waiting for the transaction to be mined (will wait up to 5 minutes).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info] Transaction Receipt:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Hash:    0x19df802de1068e648f55b949a38f5516f5a824684ae884534d65b31b5b0a9edc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Index:   1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Transaction Status:  SUCCEEDED</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Hash:          0x4fd82c1e996b947781d00280b7ce1dd5755d2d1dadc11158605bf411bc04c710</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Block Number:        15153387</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        From:                0x647E68F4BCBC843F39c80bb02da96dD13308f657</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        To:                  0x29b9a7fBb8995b2423a71cC17cf9810798F6C543</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Cumulative Gas Used: 211987</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Gas Used:            131831</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Contract Address:    None</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Logs:                0 =&gt; EthLogEntry [source=0x6B378dB654BA05395D7615Be0F07ac1B3cC9ac74] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000647e68f4bcbc843f39c80bb02da96dd13308f657,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=0000000000000000000000000000000000000000000000000de0b6b3a7640000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  ),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                             1 =&gt; EthLogEntry [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    topics=[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x8451019aab65b4193860ef723cb0d56b475a26a72b7bfc55c1dbd6121015285a,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000647e68f4bcbc843f39c80bb02da96dd13308f657,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                      0x000000000000000000000000b157256af409007d903b443349bf49a9d6a1f519</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    data=0000000000000000000000000000000000000000000000000de0b6b3a7640000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]        Events:              0 =&gt; Anonymous Event [source=0x6B378dB654BA05395D7615Be0F07ac1B3cC9ac74],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                             1 =&gt; HubTransfer [source=0x29b9a7fBb8995b2423a71cC17cf9810798F6C543] (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    from (of type address): 0x647E68F4BCBC843F39c80bb02da96dD13308f657,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    to (of type address): 0xB157256Af409007d903B443349bf49A9D6a1f519,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                    amount (of type uint256): 1000000000000000000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[info]                                  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[success] Total time: 32 s, completed Mar 23, 2021, 12:59:24 AM</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The <code>tranferThrough</code> call is a bit difficult to understand, for two reasons. Let‚Äôs look at the function signature:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice walks through tokenOwners, srcs, dests, and amounts array and executes transtive transfer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev tokenOwners[0], srcs[0], dests[0], and wads[0] constitute a transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param tokenOwners the owner of the tokens being sent in each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param srcs the sender of each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param dests the recipient of each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param wads the amount for each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transferThrough</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token parameter">address</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory tokenOwners</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">    address</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory srcs</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">    address</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory dests</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">    uint</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory wads</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Instead of transfering from one party to another in the usual ERC-20 way, here we specify potentially a series of one-to-one token exchanged between trusted parties until finally the last payer (the last element in <code>srcs</code>) pays the final recipient (the last element of <code>dests</code>). So we have to specify not a single transfer, but (potentially) a whole sequence. That‚Äôs why we have an array of sources, destinations, coins (identified by their owners), and amounts, rather than a single transfer.</p><p>This would always be a complicated function, but it looks even more arcane than it needs to, because <strong><em>sbt-ethereum</em></strong> <strong>doesn‚Äôt (yet) support resolution of address aliases within array brackets</strong>. So we had to supply all the addresses in the arguments as hex. This is‚Ä¶ not ideal.</p><p>But. We did manage to execute <code>transferThrough</code>, generating a hub transfer event, signalling to the final recipient that, not only did she receive tokens, but she received a token that directly or indirectly she has promised to trust and treat as on par with her own. She is, arguably, duty bound to provide some value in return for this transfer, in a way she would not be from some unsolicited ‚Äúordinary‚Äù transfer.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>So, we‚Äôve succeeded ‚Äúby hand‚Äù at creating an identity, funding it on the xDAI block chain, and signing it up for <em>Circles</em> on the hub contract. That generated a new ERC-20 token, of which our registered identity had an initial balance of 50 tokens. But, so long as anybody periodically ‚Äútouches‚Äù the token contract by calling <code>update</code>, we‚Äôve seen that <code>circles-identity</code>‚Äòs balance will grow over time, receiving its ‚ÄúUBI‚Äù in its own scrip.</p><p>We‚Äôve also seen that we can trust other identities, fully or partially, to define the ‚Äúcircles of trust‚Äù through which ‚Äúhub transfers‚Äù occur. Although you can send <em>Circles</em> tokens to, or receive them from, any address, ‚Äúhub transfers‚Äù have a special meaning. If you receive a token by hub transfer, it means that you‚Äôve been paid by someone whose tokens you‚Äôve directly or indirectly promised to honor. In theory, you <a href="https://www.sbt-ethereum.io/blog/2021/03/14/Circles-with-sbt-ethereum.html" target="_blank" rel="noopener noreferrer">owe them a favor in return</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="appendix-circles-hub-source-code"></a>Appendix: Circles hub source code<a class="hash-link" href="#appendix-circles-hub-source-code" title="Direct link to heading">#</a></h2><details><summary>Click here to show the full source code of the Circles hub. It includes the source code of the generated ERC-20 token contracts.</summary><div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// File: @openzeppelin/contracts/math/SafeMath.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @dev Wrappers over Solidity&#x27;s arithmetic operations with added overflow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * checks.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * Arithmetic operations in Solidity wrap on overflow. This can easily result</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * in bugs, because programmers usually assume that an overflow raises an</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * error, which is the standard behavior in high level programming languages.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * `SafeMath` restores this intuition by reverting the transaction when an</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * operation overflows.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * Using this library instead of the unchecked operations eliminates an entire</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * class of bugs, so it&#x27;s recommended to use it always.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library </span><span class="token maybe-class-name">SafeMath</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the addition of two unsigned integers, reverting on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `+` operator.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - Addition cannot overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: addition overflow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the subtraction of two unsigned integers, reverting on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * overflow (when the result is negative).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `-` operator.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - Subtraction cannot overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: subtraction overflow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the subtraction of two unsigned integers, reverting with custom message on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * overflow (when the result is negative).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `-` operator.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - Subtraction cannot overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the multiplication of two unsigned integers, reverting on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `*` operator.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - Multiplication cannot overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Gas optimization: this is cheaper than requiring &#x27;a&#x27; not being zero, but the</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// benefit is lost if &#x27;b&#x27; is also tested.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// See: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/522</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: multiplication overflow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the integer division of two unsigned integers. Reverts on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * division by zero. The result is rounded towards zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `/` operator. Note: this function uses a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `revert` opcode (which leaves remaining gas untouched) while Solidity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * uses an invalid opcode to revert (consuming all remaining gas).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - The divisor cannot be zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: division by zero&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the integer division of two unsigned integers. Reverts with custom message on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * division by zero. The result is rounded towards zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `/` operator. Note: this function uses a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `revert` opcode (which leaves remaining gas untouched) while Solidity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * uses an invalid opcode to revert (consuming all remaining gas).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - The divisor cannot be zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// assert(a == b * c + a % b); // There is no case in which this doesn&#x27;t hold</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the remainder of dividing two unsigned integers. (unsigned integer modulo),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Reverts when dividing by zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `%` operator. This function uses a `revert`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * opcode (which leaves remaining gas untouched) while Solidity uses an</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * invalid opcode to revert (consuming all remaining gas).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - The divisor cannot be zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: modulo by zero&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the remainder of dividing two unsigned integers. (unsigned integer modulo),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Reverts with custom message when dividing by zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Counterpart to Solidity&#x27;s `%` operator. This function uses a `revert`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * opcode (which leaves remaining gas untouched) while Solidity uses an</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * invalid opcode to revert (consuming all remaining gas).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - The divisor cannot be zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 b</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// File: @openzeppelin/contracts/utils/Address.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @dev Collection of functions related to the address type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library </span><span class="token maybe-class-name">Address</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns true if `account` is a contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * [IMPORTANT]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * ====</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * It is unsafe to assume that an address for which this function returns</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * false is an externally-owned account (EOA) and not a contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Among others, `isContract` will return false for the following</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * types of addresses:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *  - an externally-owned account</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *  - a contract in construction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *  - an address where a contract will be created</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *  - an address where a contract lived, but was destroyed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * ====</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">isContract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// According to EIP-1052, 0x0 is the value returned for not-yet created accounts</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// and 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470 is returned</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// for accounts without code, i.e. `keccak256(&#x27;&#x27;)`</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 codehash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 accountHash </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// solhint-disable-next-line no-inline-assembly</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> codehash </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">extcodehash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">codehash </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> accountHash </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> codehash </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Replacement for Solidity&#x27;s `transfer`: sends `amount` wei to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `recipient`, forwarding all available gas and reverting on errors.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * imposed by `transfer`, making them unable to receive funds via</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `transfer`. {sendValue} removes this limitation.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * IMPORTANT: because control is transferred to `recipient`, care must be</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * taken to not create reentrancy vulnerabilities. Consider using</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * {ReentrancyGuard} or the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sendValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address payable recipient</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">balance</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Address: insufficient balance&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// solhint-disable-next-line avoid-low-level-calls, avoid-call-value</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bool success</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">call</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> amount </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">success</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Address: unable to send value, recipient may have reverted&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Performs a Solidity function call using a low level `call`. A</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * plain`call` is an unsafe replacement for a function call: use this</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * function instead.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * If `target` reverts with a revert reason, it is bubbled up by this</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * function (like regular Solidity function calls).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Returns the raw returned data. To convert to the expected return value,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `target` must be a contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - calling `target` with `data` must not revert.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * _Available since v3.1._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">functionCall</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address target</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> bytes memory data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bytes memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">functionCall</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Address: low-level call failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `errorMessage` as a fallback revert reason when `target` reverts.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * _Available since v3.1._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">functionCall</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address target</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> bytes memory data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bytes memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_functionCallWithValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * but also transferring `value` wei to `target`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - the calling contract must have an ETH balance of at least `value`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - the called Solidity function must be `payable`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * _Available since v3.1._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">functionCallWithValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address target</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> bytes memory data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bytes memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">functionCallWithValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Address: low-level call with value failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * with `errorMessage` as a fallback revert reason when `target` reverts.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * _Available since v3.1._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">functionCallWithValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address target</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> bytes memory data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 value</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bytes memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">balance</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Address: insufficient balance for call&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_functionCallWithValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_functionCallWithValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address target</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> bytes memory data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 weiValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bytes memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">isContract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Address: call to non-contract&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// solhint-disable-next-line avoid-low-level-calls</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bool success</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> bytes memory returndata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">call</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> weiValue </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">success</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> returndata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Look for revert reason and bubble it up if present</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">returndata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// The easiest way to bubble the revert reason is using memory via assembly</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// solhint-disable-next-line no-inline-assembly</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                assembly </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> returndata_size </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">returndata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token function" style="color:rgb(130, 170, 255)">revert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">32</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> returndata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> returndata_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token function" style="color:rgb(130, 170, 255)">revert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// File: contracts/ERC20.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Based on @openzeppelin/contracts/token/ERC20/ERC20.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @dev Implementation of the {IERC20} interface.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * This implementation is agnostic to the way tokens are created. This means</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * that a supply mechanism has to be added in a derived contract using {_mint}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * For a generic mechanism see {ERC20PresetMinterPauser}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * TIP: For a detailed writeup see our guide</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * https://forum.zeppelin.solutions/t/how-to-implement-erc20-supply-mechanisms/226[How</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * to implement supply mechanisms].</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * We have followed general OpenZeppelin guidelines: functions revert instead</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * of returning `false` on failure. This behavior is nonetheless conventional</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * and does not conflict with the expectations of ERC20 applications.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * This allows applications to reconstruct the allowance for all accounts just</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * by listening to said events. Other implementations of the EIP may not emit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * these events, as it isn&#x27;t required by the specification.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * functions have been added to mitigate the well-known issues around setting</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * allowances. See {IERC20-approve}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract </span><span class="token constant" style="color:rgb(130, 170, 255)">ERC20</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using </span><span class="token maybe-class-name">SafeMath</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using </span><span class="token maybe-class-name">Address</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> _allowances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> _totalSupply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> _symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> _decimals</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * another (`to`).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Note that `value` may be zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address indexed </span><span class="token keyword module" style="font-style:italic">from</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> address indexed to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> uint256 value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * a call to {approve}. `value` is the new allowance.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Approval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address indexed owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> address indexed spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> uint256 value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the symbol of the token, usually a shorter version of the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * name.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external virtual view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">string memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> _symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Returns the number of decimals used to get its user representation.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * be displayed to a user as `5,05` (`505 / 10 ** 2`).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Tokens usually opt for a value of 18, imitating the relationship between</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Ether and Wei. This is the value {ERC20} uses, unless {_setupDecimals} is</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * called.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * NOTE: This information is only used for _display_ purposes: it in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * no way affects any of the arithmetic of the contract, including</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * {IERC20-balanceOf} and {IERC20-transfer}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">decimals</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external virtual view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> _decimals</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev See {IERC20-totalSupply}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">totalSupply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> _totalSupply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev See {IERC20-balanceOf}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev See {IERC20-transfer}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `recipient` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - the caller must have a balance of at least `amount`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address recipient</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> virtual </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev See {IERC20-allowance}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">allowance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address owner</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view virtual </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> _allowances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev See {IERC20-approve}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `spender` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">approve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address spender</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> virtual </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_approve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev See {IERC20-transferFrom}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits an {Approval} event indicating the updated allowance. This is not</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * required by the EIP. See the note at the beginning of {ERC20};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `sender` and `recipient` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `sender` must have a balance of at least `amount`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - the caller must have allowance for ``sender``&#x27;s tokens of at least</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `amount`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transferFrom</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address sender</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address recipient</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> virtual </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_approve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _allowances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: transfer amount exceeds allowance&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Atomically increases the allowance granted to `spender` by the caller.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * This is an alternative to {approve} that can be used as a mitigation for</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * problems described in {IERC20-approve}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits an {Approval} event indicating the updated allowance.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `spender` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">increaseAllowance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address spender</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 addedValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> virtual </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_approve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _allowances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">addedValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * This is an alternative to {approve} that can be used as a mitigation for</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * problems described in {IERC20-approve}.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits an {Approval} event indicating the updated allowance.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `spender` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `spender` must have allowance for the caller of at least</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * `subtractedValue`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">decreaseAllowance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address spender</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 subtractedValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> virtual </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_approve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _allowances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">subtractedValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: decreased allowance below zero&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Moves tokens `amount` from `sender` to `recipient`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * This is internal function is equivalent to {transfer}, and can be used to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * e.g. implement automatic token fees, slashing mechanisms, etc.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits a {Transfer} event.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `sender` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `recipient` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `sender` must have a balance of at least `amount`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address sender</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address recipient</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal virtual </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sender </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: transfer from the zero address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">recipient </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: transfer to the zero address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_beforeTokenTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: transfer amount exceeds balance&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** @dev Creates `amount` tokens and assigns them to `account`, increasing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * the total supply.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits a {Transfer} event with `from` set to the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `to` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_mint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address account</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal virtual </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">account </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: mint to the zero address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_beforeTokenTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _totalSupply </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _totalSupply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Destroys `amount` tokens from `account`, reducing the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * total supply.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits a {Transfer} event with `to` set to the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `account` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `account` must have at least `amount` tokens.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_burn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address account</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal virtual </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">account </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: burn from the zero address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_beforeTokenTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _balances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: burn amount exceeds balance&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _totalSupply </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _totalSupply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Sets `amount` as the allowance of `spender` over the `owner`s tokens.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * This is internal function is equivalent to `approve`, and can be used to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * e.g. set automatic allowances for certain subsystems, etc.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Emits an {Approval} event.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Requirements:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `owner` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `spender` cannot be the zero address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_approve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address owner</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address spender</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal virtual </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">owner </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: approve from the zero address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">spender </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ERC20: approve to the zero address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _allowances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Approval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> spender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Sets {decimals} to a value other than the default one of 18.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * WARNING: This function should only be called from the constructor. Most</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * applications that interact with token contracts will not expect</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * {decimals} to ever change, and may work incorrectly if it does.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_setupDecimals</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint8 decimals_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _decimals </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> decimals_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * @dev Hook that is called before any transfer of tokens. This includes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * minting and burning.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * Calling conditions:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - when `from` and `to` are both non-zero, `amount` of ``from``&#x27;s tokens</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * will be to transferred to `to`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - when `from` is zero, `amount` tokens will be minted for `to`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - when `to` is zero, `amount` of ``from``&#x27;s tokens will be burned.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * - `from` and `to` are never both zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_beforeTokenTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address </span><span class="token parameter keyword module" style="font-style:italic">from</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address to</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal virtual </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// File: contracts/interfaces/HubI.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">HubI</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">issuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">issuanceByStep</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">inflation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">divisor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">signupBonus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">pow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">totalSupply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">string memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">string memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">deployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">inflate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// File: contracts/Token.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract </span><span class="token maybe-class-name">Token</span><span class="token plain"> is </span><span class="token constant" style="color:rgb(130, 170, 255)">ERC20</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using </span><span class="token maybe-class-name">SafeMath</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable override decimals </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">18</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> lastTouched</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the timestamp of the last ubi payout</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the address of the hub this token was deployed through</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the safe that deployed this token</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> inflationOffset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the amount of seconds until the next inflation step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> currentIssuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// issanceRate at the time this token was deployed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bool </span><span class="token keyword" style="font-style:italic">private</span><span class="token plain"> manuallyStopped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// true if this token has been stopped by it&#x27;s owner</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev modifier allowing function to be only called through the hub</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    modifier </span><span class="token function" style="color:rgb(130, 170, 255)">onlyHub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev modifier allowing function to be only called by the token owner</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    modifier </span><span class="token function" style="color:rgb(130, 170, 255)">onlyOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address _owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_owner </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owner </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        hub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        lastTouched </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        inflationOffset </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">findInflationOffset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        currentIssuance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">issuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_mint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">signupBonus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for block timestamp</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the block timestamp</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> block</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for the token symbol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev all circles tokens should have the same symbol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the token symbol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view override </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">string memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for the token name</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev all circles tokens should have the same name</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the token name</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">string memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for fetching the period length from the hub</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return period length in seconds</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for fetching the number of periods from the hub</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the number of periods since the hub was deployed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for fetching the timeout from the hub</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the number of seconds the token can go without being updated before it&#x27;s deactivated</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice find the inflation step when ubi was last payed out</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev ie. if ubi was last payed out during the second inflation step, returns two</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the inflation step by count</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">periodsWhenLastTouched</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lastTouched</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">hubDeployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper functio for getting the hub deployment time</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the timestamp the hub was deployed at</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hubDeployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">deployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice Caution! manually deactivates or stops this token, no ubi will be payed out after this is called</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev intended for use in case of key loss, system failure, or migration to new contracts</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">stop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> onlyOwner </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        manuallyStopped </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice checks whether this token has been either stopped manually, or whether it has timed out</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev combines the manual stop variable with a dead man&#x27;s switch</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return true is the token is still paying out ubi, otherwise false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">stopped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">manuallyStopped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 secondsSinceLastTouched </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lastTouched</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">secondsSinceLastTouched </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice the amount of seconds until the ubi payout is next inflated</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev ubi is payed out continuously between inflation steps</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the amount of seconds until the next inflation step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">findInflationOffset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// finds the timestamp of the next inflation step, and subtracts the current timestamp</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 nextInflation </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">hubDeployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> nextInflation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice checks how much ubi this token holder is owed, but doesn&#x27;t update their balance</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev is called in the update method to write the new balance to state, but also useful in wallets</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return how much ubi this token holder is owed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">look</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// don&#x27;t payout ubi if the token has been deactivated/stopped</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">stopped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 payout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 clock </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> lastTouched</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 offset </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> inflationOffset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 rate </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> currentIssuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 p </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">periodsWhenLastTouched</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// this while loop gets executed only when we&#x27;re rolling over an inflation step </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// in the course of a ubi payout aka while we have to pay out ubi for more time</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// than lastTouched + inflationOffset</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">clock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// add the remaining offset time to the payout total at the current rate</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            payout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> payout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// adjust clock to the timestamp of the next inflation step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            clock </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> clock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the offset is now the length of 1 period</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            offset </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// increment the period we are paying out for</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            p </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// find the issuance rate as of the next period</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            rate </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">issuanceByStep</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// at this point, time() - clock should always be less than 1 period</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 timeSinceLastPayout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">clock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        payout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> payout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">timeSinceLastPayout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> payout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice receive a ubi payout</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev this is the method to actually update storage with new token balance</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">update</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 gift </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">look</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// does nothing if there&#x27;s no ubi to be payed out</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gift </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// update the state variables used to calculate ubi, then mint</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            inflationOffset </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">findInflationOffset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            lastTouched </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            currentIssuance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">issuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">_mint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gift</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice special method called by the hub to execute a transitive transaction</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param from the address the tokens are being transfered from</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param to the address the tokens are being transferred to</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param amount the amount of tokens to transfer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hubTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token parameter">address </span><span class="token parameter keyword module" style="font-style:italic">from</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address to</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 amount</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> onlyHub </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword module" style="font-style:italic">from</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address dst</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> override </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// this code shouldn&#x27;t be necessary, but when it&#x27;s removed the gas estimation methods</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// in the gnosis safe no longer work, still true as of solidity 7.1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// File: contracts/Hub.sol</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract </span><span class="token maybe-class-name">Hub</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using </span><span class="token maybe-class-name">SafeMath</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable inflation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the inflation rate expressed as 1 + percentage inflation, aka 7% inflation is 107</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable divisor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the largest power of 10 the inflation rate can be divided by</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the amount of sections between inflation steps</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable signupBonus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// a one-time payout made immediately on signup</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable initialIssuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the starting payout per second, this gets inflated by the inflation rate</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable deployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the timestamp this contract was deployed at</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> immutable timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// longest a token can go without a ubi payout before it gets deactivated</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token maybe-class-name">Token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> tokenToUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Signup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address indexed user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> address token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">OrganizationSignup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address indexed organization</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Trust</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address indexed canSendTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> address indexed user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> uint256 limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address indexed </span><span class="token keyword module" style="font-style:italic">from</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> address indexed to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> uint256 amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// some data types used for validating transitive transfers</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    struct transferValidator </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bool seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 sent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 received</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> transferValidator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token parameter">uint256 _inflation</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 _period</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        string memory _symbol</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        string memory _name</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 _signupBonus</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 _initialIssuance</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 _timeout</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        inflation </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _inflation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        divisor </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">findDivisor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_inflation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        period </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        symbol </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _symbol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        signupBonus </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _signupBonus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        initialIssuance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _initialIssuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        deployedAt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> block</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        timeout </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice calculates the correct divisor for the given inflation rate</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev the divisor is used to maintain precision when doing math with percentages</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param _inf the inflation rate</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the largest power of ten the inflation rate can be divided by</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">findDivisor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 _inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 iter </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">pow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> iter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            iter </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">pow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> iter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice helper function for finding the amount of inflation periods since this hub was deployed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the amount of periods since hub was deployed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">deployedAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice calculates the current issuance rate per second</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev current issuance is the initial issuance inflated by the amount of inflation periods since the hub was deployed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return current issuance rate</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">issuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">inflate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">initialIssuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice finds the inflation rate at a given inflation period</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param _periods the step to calculate the issuance rate at</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return inflation rate as of the given period</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">issuanceByStep</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 _periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">inflate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">initialIssuance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice find the current issuance rate for any initial issuance and amount of periods</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev this is basically the calculation for compound interest, with some adjustments because of integer math</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param _initial the starting issuance rate</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param _periods the step to calculate the issuance rate as of</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return initial issuance rate as if interest (inflation) has been compounded period times</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">inflate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 _initial</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 _periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// this returns P * (1 + r) ** t - which is a the formula for compound interest if </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// interest is compounded only once per period</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// in our case, currentIssuanceRate = initialIssuance * (inflation) ** periods</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 q </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">pow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">inflation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 d </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">pow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">divisor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_initial</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice signup to this circles hub - create a circles token and join the trust graph</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev signup is permanent, there&#x27;s no way to unsignup</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">signup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// signup can only be called once</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You can&#x27;t sign up twice&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// organizations cannot sign up for a token</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Organizations cannot signup as normal users&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token maybe-class-name">Token</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        tokenToUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// every user must trust themselves with a weight of 100</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// this is so that all users accept their own token at all times</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_trust</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Signup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice register an organization address with the hub and join the trust graph</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev signup is permanent for organizations too, there&#x27;s no way to unsignup</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">organizationSignup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// can&#x27;t register as an organization if you have a token</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Normal users cannot signup as organizations&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// can&#x27;t register as an organization twice</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You can&#x27;t sign up as an organization twice&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">OrganizationSignup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice trust a user, calling this means you&#x27;re able to receive tokens from this user transitively</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev the trust graph is weighted and directed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param user the user to be trusted</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param limit the amount this user is trusted, as a percentage of 100</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">trust</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address user</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// only users who have signed up as tokens or organizations can enter the trust graph</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You can only trust people after you&#x27;ve signed up!&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// you must continue to trust yourself 100%</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You can&#x27;t untrust yourself&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// organizations can&#x27;t receive trust since they don&#x27;t have their own token (ie. there&#x27;s nothing to trust)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You can&#x27;t trust an organization&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// must a percentage</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">limit </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Limit must be a percentage out of 100&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// organizations don&#x27;t have a token to base send limits off of, so they can only trust at rates 0 or 100</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">limit </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> limit </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Trust is binary for organizations&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">_trust</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev used internally in both the trust function and signup</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param user the user to be trusted</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param limit the amount this user is trusted, as a percentage of 100</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_trust</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address user</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Trust</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev this is an implementation of exponentiation by squares</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param base the base to be used in the calculation</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param exponent the exponent to be used in the calculation</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the result of the calculation</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">pow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 base</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint256 exponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> pure </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">base </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">exponent </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">exponent </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">exponent </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">exponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                base </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exponent </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> exponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                base </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exponent </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">exponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> base</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice finds the maximum amount of a specific token that can be sent between two users</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev the goal of this function is to always return a sensible number, it&#x27;s used to validate transfer throughs, and also heavily in the graph/pathfinding services</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param tokenOwner the safe/owner that the token was minted to</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param src the sender of the tokens</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param dest the recipient of the tokens</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @return the amount of tokenowner&#x27;s token src can send to dest</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">checkSendLimit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address tokenOwner</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address src</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// there is no trust</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">tokenOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if dest hasn&#x27;t signed up, they cannot trust anyone</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//if the token doesn&#x27;t exist, it can&#x27;t be sent/accepted</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">tokenOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 srcBalance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">tokenOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if sending dest&#x27;s token to dest, src can send 100% of their holdings</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// for organizations, trust is binary - if trust is not 0, src can send 100% of their holdings</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">tokenOwner </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> dest </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> organizations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> srcBalance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// find the amount dest already has of the token that&#x27;s being sent</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 destBalance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">tokenOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 oneHundred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// find the maximum possible amount based on dest&#x27;s trust limit for this token</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 max </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">tokenOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">oneHundred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if trustLimit has already been overriden by a direct transfer, nothing more can be sent</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">max </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> destBalance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 destBalanceScaled </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> destBalance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">oneHundred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">tokenOwner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">oneHundred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// return the max amount dest is willing to hold minus the amount they already have</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> max</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">destBalanceScaled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev builds the validation data structures, called for each transaction step of a transtive transactions</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param src the sender of a single transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param dest the recipient of a single transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param wad the amount being passed along a single transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">buildValidationData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address src</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> address dest</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> uint wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the validation mapping has this format</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// { address: {</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//     seen: whether this user is part of the transaction,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//     sent: total amount sent by this user,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//     received: total amount received by this user,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//    }</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// }</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">seen</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if we have seen the addresses, increment their sent amounts</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if we haven&#x27;t, add them to the validation mapping</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">seen</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">seen</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if we have seen the addresses, increment their sent amounts</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if we haven&#x27;t, add them to the validation mapping</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">seen</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev performs the validation for an attempted transitive transfer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param steps the number of steps in the transitive transaction</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">validateTransferThrough</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint256 steps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// a valid path has only one real sender and receiver</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// iterate through the array of all the addresses that were part of the transaction data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            transferValidator memory curr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if the address sent more than they received, they are the sender</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">curr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> curr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if we&#x27;ve already found a sender, transaction is invalid</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Path sends from more than one src&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the real token sender must also be the transaction sender</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Path doesn&#x27;t send from transaction sender&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                src </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if the address received more than they sent, they are the recipient</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">curr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> curr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// if we&#x27;ve already found a recipient, transaction is invalid</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dest </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Path sends to more than one dest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                dest </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// a valid path has both a sender and a recipient</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Transaction must have a src&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dest </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Transaction must have a dest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// sender should not recieve, recipient should not send</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// by this point in the code, we should have one src and one dest and no one else&#x27;s balance should change</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Sender is receiving&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Recipient is sending&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the total amounts sent and received by sender and recipient should match</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">received</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Unequal sent and received amounts&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// the maximum amount of addresses we should see is one more than steps in the path</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> steps </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Seen too many addresses&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">HubTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// clean up the validation datastructures</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">delete</span><span class="token plain"> validation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">delete</span><span class="token plain"> seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// sanity check that we cleaned everything up correctly</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">seen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Seen should be empty&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @notice walks through tokenOwners, srcs, dests, and amounts array and executes transtive transfer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @dev tokenOwners[0], srcs[0], dests[0], and wads[0] constitute a transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param tokenOwners the owner of the tokens being sent in each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param srcs the sender of each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param dests the recipient of each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/// @param wads the amount for each transaction step</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transferThrough</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token parameter">address</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory tokenOwners</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        address</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory srcs</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        address</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory dests</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token parameter"> memory wads</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// all the arrays must be the same length</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> tokenOwners</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Tokens array length must equal dests array&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">srcs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> tokenOwners</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Tokens array length must equal srcs array&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">wads</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> tokenOwners</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Tokens array length must equal amounts array&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> srcs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address src </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> srcs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address dest </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> dests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address token </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tokenOwners</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            uint256 wad </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> wads</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// check that no trust limits are violated</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            uint256 max </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">checkSendLimit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">wad </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> max</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Trust limit exceeded&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">buildValidationData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// go ahead and do the transfers now so that we don&#x27;t have to walk through this array again</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            userToToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">hubTransfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> wad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// this will revert if there are any problems found</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">validateTransferThrough</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">srcs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></details></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/CirclesUBI/circles-handbook/edit/main/docs/developers/tutorials/circles-by-hand-with-sbt-ethereum.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-web-app-is-weird" class="table-of-contents__link">The web-app is weird</a></li><li><a href="#circles-contracts" class="table-of-contents__link">Circles contracts</a></li><li><a href="#circles-by-hand" class="table-of-contents__link">Circles by hand</a><ul><li><a href="#create-a-new-project" class="table-of-contents__link">Create a new project</a></li><li><a href="#check-out-buildsbt" class="table-of-contents__link">Check out build.sbt</a></li><li><a href="#startup-sbt-ethereum" class="table-of-contents__link">Startup sbt-ethereum</a></li></ul></li><li><a href="#create-a-wallet-for-our-circles-identity" class="table-of-contents__link">Create a wallet for our Circles identity</a></li><li><a href="#prepare-to-work-with-the-circles-hub" class="table-of-contents__link">Prepare to work with the Circles hub</a></li><li><a href="#fund-our-circles-identity" class="table-of-contents__link">Fund our Circles identity</a></li><li><a href="#sign-up-for-circles-as-our-new-identity" class="table-of-contents__link">Sign up for Circles as our new identity</a></li><li><a href="#working-with-our-me-coin" class="table-of-contents__link">Working with our ‚Äúme-coin‚Äù</a></li><li><a href="#trust-trust-trust" class="table-of-contents__link">Trust trust trust</a></li><li><a href="#collecting-our-ubi" class="table-of-contents__link">Collecting our ‚ÄúUBI‚Äù</a></li><li><a href="#using-transferthrough-to-make-a-hub-transfer" class="table-of-contents__link">Using <code>transferThrough</code> to make a ‚Äúhub transfer‚Äù</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li><li><a href="#appendix-circles-hub-source-code" class="table-of-contents__link">Appendix: Circles hub source code</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Handbook</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/users">Users</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/communities">Communities</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developers">Developers</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developers/whitepaper">Whitepaper</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://chat.joincircles.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chat</a></li><li class="footer__item"><a href="https://aboutcircles.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li><li class="footer__item"><a href="https://twitter.com/CirclesUBI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://github.com/CirclesUBI" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://joincircles.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://circles.garden" target="_blank" rel="noopener noreferrer" class="footer__link-item">Circles Wallet</a></li><li class="footer__item"><a href="https://github.com/CirclesUBI/.github/blob/main/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code of Conduct</a></li><li class="footer__item"><a href="https://github.com/CirclesUBI/.github/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribute</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Creative Commons Attribution Share Alike 4.0 International</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c3b470af.js"></script>
<script src="/assets/js/main.4528a3a6.js"></script>
</body>
</html>